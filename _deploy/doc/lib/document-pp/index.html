<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Pretty printing</title>
    <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://melt.cs.umn.edu/lib/document-pp/">
    
    <script src="/js/nav.js"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Silver Documentation</a>

  </div>

</header>


    <div class="site-nav">
      

<ul class="nav">

    
    <li>
    
        <a href="doc/">Home</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/install-guide/">Installation guide</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/command-line-reference/">Command line reference</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/faq/">Frequently asked questions (FAQ)</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/error-faq/">Frequently found errors (FFE)</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Tutorials (TODO)
    
    
        

<ul class="nav">

    
    <li>
    
        Intro to AGs - dc?
    
    
    </li>

    
    <li>
    
        Simple
    
    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Concepts
    
    
        

<ul class="nav">

    
    <li>
    
        Attribute grammars
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/decorated-vs-undecorated/">Decorated vs undecorated</a>
    
    
    </li>

    
    <li>
    
        Forwarding
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/aspects/">Aspects</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/collections/">Collection attributes</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/modules/">The module system</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/types/">Types</a>
    
    
    </li>

    
    <li>
    
        Concrete syntax
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/io/">IO</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/lr-parsing/">LR parsing</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/ffi/">Foreign Function Interface</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/modular-well-definedness/">Modular well-definedness</a>
    
    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Language reference
    
    
        

<ul class="nav">

    
    <li class="collapsible collapsed">
    
        Declarations
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/decl/nonterminals/">Nonterminals</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        <a href="doc/ref/decl/productions/">Productions</a>
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/decl/productions/concrete/">Concrete</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/productions/aspect/">Aspect</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/productions/default/">Default</a>
    
    
    </li>

</ul>

    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/attributes/">Attributes</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/occurs/">Occurs</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/functions/">Functions</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/globals/">Global values</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/types/">Type declarations</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/parsers/">Parser declarations</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/terminals/">Terminals</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/annotations/">Annotations</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Copper-specific
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/decl/copper/parser-attribute/">Parser attributes</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/copper/lexer-class/">Lexer classes</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/copper/disambiguate/">Disambiguation functions</a>
    
    
    </li>

</ul>

    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Production body
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/stmt/equations/">Equations</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/stmt/forwarding/">Forwards to</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/stmt/locals/">Locals</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/stmt/return/">Return</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Copper-specific
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/stmt/copper/pluck/">Pluck</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/stmt/copper/print/">Print</a>
    
    
    </li>

</ul>

    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Expressions
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/expr/calls/">Function/production application</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/attribute-access/">Attribute access</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/booleans/">Boolean expressions</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/comparisons/">Comparison operators</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/numeric/">Numeric expressions</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/decorate/">Decorate with</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/new/">New (undecorate)</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/terminal/">Terminal literals</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/pattern-matching/">Pattern matching</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/let/">Lets</a>
    
    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Extensions
    
    
        

<ul class="nav">

    
    <li>
    
        List syntax
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/ext/easy-terminal/">Easy terminals</a>
    
    
    </li>

    
    <li>
    
        Convenience
    
    
    </li>

</ul>

    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Library reference
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/lib/string/">String</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/pair/">Pair</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/list/">List</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/maybe/">Maybe</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/io/">IO</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/document-pp/">Document (pp)</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/other/">Other</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/comparison/">Comparison fns</a>
    
    
    </li>

</ul>

    
    </li>

    
    <li>
    
        <a href="doc/bibliography/">Bibliography</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/style-guide/">Style guide</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Development
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/dev/building/">Building Silver</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/code-organization/">Code organization</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/runtime-editing/">Runtime development</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/long-term-todo/">Silver popularity todo list</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Eclipse
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/dev/eclipse/getting-started/">Getting started</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/eclipse/ide-decl/">Creating an IDE plugin</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/eclipse/internals/">Eclipse internals docs</a>
    
    
    </li>

</ul>

    
    </li>

</ul>

    
    </li>

</ul>

    </div>

    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Pretty printing</h1>
  </header>

  <article class="post-content">
    <h1 id="required-code-for-use">Required Code for Use</h1>
<p>The following import statements are required for using the pretty print extension.</p>

<pre><code>imports silver:langutil;
imports silver:langutil:pp;
</code></pre>

<p>To declare a pretty print attribute on a nonterminal, attach it using a ‘with’ clause. For example, to add a pretty print attribute to a nonterminal called Root, add ‘with pp’ to the declaration of Root.</p>

<pre><code>nonterminal Root with pp;
</code></pre>

<h1 id="show">Show</h1>
<p>To return the string equivalent of a attribute, use the function show with the width of the string and the pp attribute itself.</p>

<pre><code>abstract production root
r::Root ::= e::Expr
{
  local attribute s::String;
  s = show(100,r.pp);

  ...
}
</code></pre>

<h1 id="pp-constructors">PP Constructors</h1>
<p>The examples below show the document function and the strings they represent.<br />
Ex:<br />
<code>
pp_constructor(params) = "string equivalent"
</code></p>

<h2 id="literals">Literals</h2>
<ul>
  <li><code> text("foo") = "foo" </code></li>
</ul>

<h2 id="punctuation">Punctuation</h2>
<ul>
  <li><code> space() = " " </code></li>
  <li><code> semi() = ";" </code></li>
  <li><code> comma() = "," </code></li>
  <li><code> braces(foo) = "{" ++ foo ++ "}" </code></li>
  <li><code> parens(foo) = "(" ++ foo ++ ")" </code></li>
  <li><code> brackets(foo) = "[" ++ foo ++ "]" </code></li>
  <li><code> notext() = "" </code></li>
</ul>

<p>In general, these should NOT be preferred over just using that punctuation directly! These are useful only in situations where it make sense and it keeps things simpler.</p>

<p>For example, <code>implode(comma(), list)</code> is okay, but as soon as you need a space, it’s better to just write <code>implode(text(", "), list)</code> instead. Whatever you do, never write <code>implode(cat(comma(), space()), list)</code> because that’s just horrible.</p>

<h2 id="concatenation">Concatenation</h2>
<ul>
  <li><code> cat(foo, bar) = foo ++ bar </code></li>
  <li><code> concat([ text("foo"), text("bar"), text("test")]) = "foobartest" </code> Folds a list of Documents together using cat</li>
  <li><code> implode(text("|"), [text("foo"), text("bar"), text("test")]) = "foo|bar|test" </code> Places a string between each element of a list of strings.</li>
  <li><code> terminate(text("|"), [text("foo"), text("bar"), text("test")]) = "foo|bar|test|" </code> Similar to implode. Places a string between each element of a list of strings AND at the end.</li>
</ul>

<h2 id="grouping-newlines-and-indentation">Grouping, newlines, and indentation</h2>
<ul>
  <li><code>group(inner)</code> creates a new <em>indentation group</em> for <code>inner</code>. That is, every occurrence of <code>line()</code> inside <code>inner</code> that isn’t itself contained by an intervening <code>group</code> will either ALL be horizontal (spaces) or all be vertical (newlines.) Every Document begins with an initial, implicit, outer group that is automatically vertical.</li>
  <li><code>line()</code> is a <strong>potential</strong> newline point, or a space if the group it belongs to decides to be horizontal instead. Note that in addition to becoming a newline, it will also emit a number of space equal to the current indentation level.</li>
  <li><code>nest(depth, inner)</code> increases the current indentation level for all <code>line()</code>s in <code>inner</code>. Note that it’s for <strong>all</strong> of them, <code>nest</code> does not just affect the current group or anything like that.</li>
</ul>

<h2 id="common-pattern-helpers">Common pattern helpers</h2>
<ul>
  <li><code>groupnest(depth, inner)</code> performs both a group and a nest operation at once.</li>
  <li><code>nestlines(depth, inner)</code> gets right an extremely common pattern that’s slightly tricky to do. This construct nests <code>inner</code> and puts a newline before and after it. The before newline is inside the nest, but the after newline is OUTSIDE the nest. This is the correct behavior for, for example, nesting statements.</li>
  <li><code>softbreak()</code> is equivalent to <code>group(line())</code>. That is, it’s a potential place for a newline, but can be taken without committing to turning anything else into newlines versus spaces.</li>
  <li><code>box(inner)</code> is equivalent to a <code>nest</code> but sets the indentation level to whatever the current indentation is. This makes it easier to line things up vertically at an unknown resulting indentation level.</li>
</ul>

<h2 id="two-pieces-of-advice">Two pieces of advice</h2>

<ul>
  <li>Do not use <code>group</code> at all until you get to, say, expressions. Creating the option to place, for example, statements horizontally is usually a very bad idea.</li>
  <li>Use <code>nestlines</code> because it gets indentation right.</li>
</ul>

<p>As an example, to correct indent something like the braces after an “if statement” you would write:</p>

<p><code> braces(nestlines(2, implode(line(), stmts))) </code></p>

<p>This would produce outputs like:</p>

<pre><code>if(expr) {    &lt;--- this opening brace is where the above starts
  stmt1;      &lt;--- this is why the first newline is *inside* the nest
  stmt2;      &lt;--- the 'implode' does NOT put the newline here, nestlines does.
}             &lt;--- the last newline is *outside* the nest, and followed by }
</code></pre>

<p>if(expr) {    &lt;— this opening brace is where the above starts<br />
  stmt1;      &lt;— this is why the first newline is <em>inside</em> the nest<br />
  stmt2;      &lt;— the ‘implode’ does NOT put the newline here, nestlines does.<br />
}             &lt;— the last newline is <em>outside</em> the nest, and followed by }<br />
}}}```</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

  </div>

</footer>

<script>nav_hook();</script>


  </body>

</html>
