<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Concrete productions</title>
    <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://melt.cs.umn.edu/ref/decl/productions/concrete/">
    
    <script src="/js/nav.js"></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Silver Documentation</a>

  </div>

</header>


    <div class="site-nav">
      

<ul class="nav">

    
    <li>
    
        <a href="doc/">Home</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/install-guide/">Installation guide</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/command-line-reference/">Command line reference</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/faq/">Frequently asked questions (FAQ)</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/error-faq/">Frequently found errors (FFE)</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Tutorials (TODO)
    
    
        

<ul class="nav">

    
    <li>
    
        Intro to AGs - dc?
    
    
    </li>

    
    <li>
    
        Simple
    
    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Concepts
    
    
        

<ul class="nav">

    
    <li>
    
        Attribute grammars
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/decorated-vs-undecorated/">Decorated vs undecorated</a>
    
    
    </li>

    
    <li>
    
        Forwarding
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/aspects/">Aspects</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/collections/">Collection attributes</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/modules/">The module system</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/types/">Types</a>
    
    
    </li>

    
    <li>
    
        Concrete syntax
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/io/">IO</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/lr-parsing/">LR parsing</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/ffi/">Foreign Function Interface</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/concepts/modular-well-definedness/">Modular well-definedness</a>
    
    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Language reference
    
    
        

<ul class="nav">

    
    <li class="collapsible collapsed">
    
        Declarations
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/decl/nonterminals/">Nonterminals</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        <a href="doc/ref/decl/productions/">Productions</a>
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/decl/productions/concrete/">Concrete</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/productions/aspect/">Aspect</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/productions/default/">Default</a>
    
    
    </li>

</ul>

    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/attributes/">Attributes</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/occurs/">Occurs</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/functions/">Functions</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/globals/">Global values</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/types/">Type declarations</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/parsers/">Parser declarations</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/terminals/">Terminals</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/annotations/">Annotations</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Copper-specific
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/decl/copper/parser-attribute/">Parser attributes</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/copper/lexer-class/">Lexer classes</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/decl/copper/disambiguate/">Disambiguation functions</a>
    
    
    </li>

</ul>

    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Production body
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/stmt/equations/">Equations</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/stmt/forwarding/">Forwards to</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/stmt/locals/">Locals</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/stmt/return/">Return</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Copper-specific
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/stmt/copper/pluck/">Pluck</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/stmt/copper/print/">Print</a>
    
    
    </li>

</ul>

    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Expressions
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/ref/expr/calls/">Function/production application</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/attribute-access/">Attribute access</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/booleans/">Boolean expressions</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/comparisons/">Comparison operators</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/numeric/">Numeric expressions</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/decorate/">Decorate with</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/new/">New (undecorate)</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/terminal/">Terminal literals</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/pattern-matching/">Pattern matching</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/expr/let/">Lets</a>
    
    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Extensions
    
    
        

<ul class="nav">

    
    <li>
    
        List syntax
    
    
    </li>

    
    <li>
    
        <a href="doc/ref/ext/easy-terminal/">Easy terminals</a>
    
    
    </li>

    
    <li>
    
        Convenience
    
    
    </li>

</ul>

    
    </li>

</ul>

    
    </li>

    
    <li class="collapsible collapsed">
    
        Library reference
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/lib/string/">String</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/pair/">Pair</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/list/">List</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/maybe/">Maybe</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/io/">IO</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/document-pp/">Document (pp)</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/other/">Other</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/lib/comparison/">Comparison fns</a>
    
    
    </li>

</ul>

    
    </li>

    
    <li>
    
        <a href="doc/bibliography/">Bibliography</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/style-guide/">Style guide</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Development
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/dev/building/">Building Silver</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/code-organization/">Code organization</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/runtime-editing/">Runtime development</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/long-term-todo/">Silver popularity todo list</a>
    
    
    </li>

    
    <li class="collapsible collapsed">
    
        Eclipse
    
    
        

<ul class="nav">

    
    <li>
    
        <a href="doc/dev/eclipse/getting-started/">Getting started</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/eclipse/ide-decl/">Creating an IDE plugin</a>
    
    
    </li>

    
    <li>
    
        <a href="doc/dev/eclipse/internals/">Eclipse internals docs</a>
    
    
    </li>

</ul>

    
    </li>

</ul>

    
    </li>

</ul>

    </div>

    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Concrete productions</h1>
  </header>

  <article class="post-content">
    <ul id="markdown-toc">
  <li><a href="#syntax">Syntax</a></li>
  <li><a href="#convenience-for-concrete-syntax">Convenience for concrete syntax</a></li>
  <li><a href="#easy-terminal-extension">Easy terminal extension</a></li>
  <li><a href="#concrete-syntax-modifiers">Concrete syntax modifiers</a>    <ul>
      <li><a href="#production-precedence">Production precedence</a></li>
      <li><a href="#production-operator">Production operator</a></li>
      <li><a href="#copper-action-blocks">Copper action blocks</a></li>
      <li><a href="#layout">Layout</a></li>
      <li><a href="#multiple-production-modifiers">Multiple production modifiers</a></li>
    </ul>
  </li>
</ul>

<pre><code>concrete production plus
e::Expr ::= e1::Expr  '+'  e2::Expr
{
}
</code></pre>

<h2 id="syntax">Syntax</h2>

<p>A ‘concrete’ production is identical to an <a href="doc/ref/decl/productions/">abstract production</a>, except that it will be sent to the parser generator, if a parser is declared that includes the grammar the production is defined in.</p>

<p>Concrete productions also have restrictions on the types of children, only terminals and nonterminals are allowed (and those nonterminals must have concrete productions).</p>

<h2 id="convenience-for-concrete-syntax">Convenience for concrete syntax</h2>

<p>Syntax can be declared is a somewhat more natural way using <code>concrete productions</code> (note the plural.)</p>

<pre><code>concrete productions  e::Expr
| e1::Expr '+' e2::Expr
    { e.ast = ast:plus(e1.ast, e2.ast); }
| 'if' e1::Expr 
  'then' e2::Expr
  'else' e3::Expr
    { e.ast = ast:ifthen(e1.ast, e2.ast, e3.ast); }
(named) | 'whatever'
    { 
</code></pre>

<p>This allows a dramatically more succinct description of concrete syntax. Names of these productions are auto-generated as they’re typically unnecessary, but if they are needed, the third case above shows how they can be provided.</p>

<h2 id="easy-terminal-extension">Easy terminal extension</h2>

<p>The easy terminal extension allows <a href="doc/ref/decl/terminals/">terminals declared using single quotes</a> to be referred to by those same single quotes, instead of by name.</p>

<p>This is already shown in the example above with e.g. <code>'+'</code> and <code>'if'</code>.</p>

<h2 id="concrete-syntax-modifiers">Concrete syntax modifiers</h2>

<p>There are three additional pieces of information that may be attached to concrete productions:</p>

<h3 id="production-precedence">Production precedence</h3>

<p>Reduce/reduce conflicts <em>may</em> be resolved by specifying the relative precedence of productions (emphasis on may, as this might not be the best way to resolve reduce/reduce conflicts, some refactoring of the grammar may be preferable.)</p>

<pre><code>concrete production something
s::Stmt ::= 'some' 'syntax'
precedence = 10
{
}
</code></pre>

<p><em>TODO: get a better example. Might be hard to find a good example because this is usually a poor choice, but a real world one is preferable!</em></p>

<h3 id="production-operator">Production operator</h3>

<p>Terminal operator precedence works by inferring the operator to use for a production: the last operator terminal in the signature. This is then compared to the input terminal to decide between shift and reduce.</p>

<p>Although this is nearly always correct (or reasonable), sometimes it is not. It can be amended by declaring the terminal which should be used as it’s operator for ambiguity resolution purposes, even if that terminal is not one that appears in the signature.</p>

<pre><code>concrete production arrow
e::Expr ::= e1::Expr '-' '&gt;' e2::Expr
operator = Arrow_t
{
}
</code></pre>

<h3 id="copper-action-blocks">Copper action blocks</h3>

<p>Productions can be associated with an action to perform when that production is reduced (which occurs after all children have been reduced.)</p>

<pre><code>concrete production typedef
d::Decl ::= 'typedef' t::Type ids::Identifiers ';'
{
}
action {
  typenames = (decorate ids with {}).names ++ typenames;
}
</code></pre>

<p>It is possible to examine the children of the production, but only the undecorated forms are available for use.  Autodecoration behavior is not present in action blocks. (Thus, the explicit decorate in the above code.)</p>

<h3 id="layout">Layout</h3>

<p>Presently, the ignored whitespace (the “layout”) of a production defaults to all ignore terminals included in the parser. This is not ideal and will likely change in the future to something more modular.</p>

<p>The layout is a set of ignored terminals inserted between every element on the right-hand side of a production. So:</p>

<pre><code>Decl ::= 'typedef' Type Identifiers ';'
</code></pre>

<p>will (in effect) be expanded to</p>

<pre><code>Decl ::= 'typedef' Layout Type Layout Identifiers Layout ';'
</code></pre>

<p>Note that before and after the first and last signature element there is no <code>Layout</code> added: that’s the responsibility of the parent production, whatever that may be.</p>

<p>To control the layout on a specific production, an explicit set of terminals can be supplied:</p>

<pre><code>concrete production parameterizedString
e::Expr ::= 's' '"' s::StringBody '"'
layout {}
{
  ...
}
</code></pre>

<p>In this example, we’ve suppressed all layout for <em>this production only</em>, and so we’d presumably also want to add this line to every production of <code>StringBody</code>, too.</p>

<h3 id="multiple-production-modifiers">Multiple production modifiers</h3>

<p>Are separate with a comma, for example:</p>

<pre><code>concrete production foo
e::Expr ::= Foo
operator = Bar, layout { Newline, Space }, precedence = 2
{
}
</code></pre>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

  </div>

</footer>

<script>nav_hook();</script>


  </body>

</html>
